### 用 Factory 封装类

- 实现

  - 把类的构造函数声明为非公共的，并通过 Factory 来创建它们的实例
  - 赋予这个 Factory 创建和返回实现了同一结构的类的实例的能力

- 动机

  - 客户代码不需要知道这些类的存在
  - 这些类都实现同一个接口，并且不太会发生改变

- 优点

  - 通过意图导向的 Creation Method 简化了不同种类实例的创建
  - 通过隐藏不需要公开的类减少了包结构的 “概念重量”
  - 帮助严格执行“面向接口编程，而不是面向实现”这一格言

- 缺点

  - 当需要创建新种类的实例时，必须新建/更新 Creation Method
  - 当客户只能获得 Factory 的二进制代码而无法获得源码时，对 Factory 的指定将受到限制

- 做法

  - 1. 找到调用类的构造函数来创建实例的一段客户代码。对构造函数调用应用提炼方法重构，生成一个公共、静态的方法。这个新方法就是一个 Creation Method。然后应用搬移方法将 Creation Method 搬移到包含所选构造函数的类的超类中
  - 2. 找出调用所选构造函数来创建相同实例的所有代码，将它们更新为调用 Creation Method
  - 3. 对可能使用类的构造函数创建的所有类型的实例重复步骤（1）和步骤（2）
  - 4. 把类的构造函数声明为非公共
  - 5. 对所有需要封装的类重构步骤（1）~步骤（4）

- 视频

[重构与模式 - 用 Factory 封装类](https://www.bilibili.com/video/BV197411U7bx/)
