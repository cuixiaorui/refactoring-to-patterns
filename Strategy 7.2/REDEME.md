# 用 strategy 替换条件逻辑

- 实现

  - 为每个变体创建一个 Strategy 并使方法把计算委托到 Strategy 实例

- 动机

  - 复杂的条件逻辑导致复杂度上升时

- 优点

  - 通过减少或去除条件逻辑使算法变得清晰易懂
  - 通过把算法的变体搬移到类层次中简化了类
  - 允许在运行时用一种算法替换另一种算法

- 缺点

  - 当应用基于继承的解决方案或”简化条件表达式“中的重构更简单时，会增加设计的复杂度
  - 增加了算法如何获取或接受上下文类的数据的复杂度

- 做法

  - 确定上下文，包含很多条件逻辑的计算方法所在的类
  - 创建一个策略类

    - 在类名后添加“Strategy”

  - 应用搬移方法重构把计算方法搬移到策略中

    - 上下文类中需要先暴露这个一个计算方法，把它委托到策略类中的计算方法
    - 传数据

      - 时机

        - 需要传入的参数较少

      - 优点

        - 只涉及上下文类与策略类的最小耦合

      - 缺点

        - 无论具体的策略类是否需要这些数据，都必须传入到每个具体策略类中

    - 传上下文类

      - 时机

        - 需要传入的参数比较多时

      - 缺点

        - 破坏信息隐藏

      - 优点

        - 在上下类添加了方法，所有的策略类中都可以使用

  - 使用提炼参数重构让客户用策略类的一个实例装配上下文类
  - 在策略类的计算方法上应用多态替换条件式重构

    - 使用子类替换类型代码重构

      - 声明多个子策略类

    - 尽量把策略类声明为抽象类

      - 子类重写